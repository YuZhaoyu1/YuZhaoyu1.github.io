<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>MD5碰撞学习</title>
      <link href="/2024/01/24/md5-peng-zhuang-xue-xi/"/>
      <url>/2024/01/24/md5-peng-zhuang-xue-xi/</url>
      
        <content type="html"><![CDATA[<p>在CTF中，我遇到了以下的问题</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>        <span class="token variable">$flag</span><span class="token operator">=</span><span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>        <span class="token variable">$v1</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token variable">$v2</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">ctype_alpha</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"v1 error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"v2 error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>                    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"where is flag?"</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>在题目中，只有GET方法传入的v1为字符串，v2为数字，并且它们两个的md5值相同时才能得到flag，要实现这样的效果，就要实现它们两个的MD5碰撞。</p><h3 id="PHP中的弱比较"><a href="#PHP中的弱比较" class="headerlink" title="PHP中的弱比较"></a>PHP中的弱比较</h3><ol><li>字符串与int类型的比较，先判断字符串开头是否为数字，如果不是，则判断为false，如果是的话，就把字符串中的第一个字母出现前的数字截取进行比较，比如“123a234”就截取123与int比较</li><li>上述问题是字符串之间的比较，无法以第一种方法绕开，可以用0e开头的方法绕过，因为PHP中认为e是指数运算，比如0e123代表0的123次方，所以只要把两个字符串构造为0e开头的并且后面没有字母，就可以比较为true，因为0的任何次方都是0</li></ol><p>针对上面的题目，只要构造字符串v1和数字v2的MD5值都是0e开头的并且后面没有字母即可得到flag</p><h3 id="构造方法"><a href="#构造方法" class="headerlink" title="构造方法"></a>构造方法</h3><ol><li>使用以下python脚本，我这里为纯数字字符串，视情况修改</li></ol><pre class="line-numbers language-python3" data-language="python3"><code class="language-python3">import hashlibimport itertoolsimport stringfrom tqdm import tqdmdef md5(s):    return hashlib.md5(s.encode()).hexdigest()def find_string():    for length in tqdm(range(9, 10)):        for combination in itertools.product(string.digits, repeat=length):            candidate = ''.join(combination)            if md5(candidate).startswith('0e') and not any(c.isalpha() for c in md5(candidate)):                return candidateresult = find_string()print(result)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="2"><li>以上方法太费时间，建议直接在网上寻找</li></ol><pre class="line-numbers language-text" data-language="text"><code class="language-text">一些MD5值为0e开头的字符串：QNKCDZO   =&gt; 0e830400451993494058024219903391240610708 =&gt; 0e462097431906509019562988736854s878926199a =&gt; 0e545993274517709034328855841020s155964671a =&gt; 0e342768416822451524974117254469s214587387a =&gt; 0e848240448830537924465865611904s214587387a =&gt; 0e848240448830537924465865611904<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>参考：<a href="https://link.zhihu.com/?target=https://www.cnblogs.com/Oran9e/p/6537204.html">0e开头MD5值小结 - Oran9e - 博客园</a> 博客</p><p>如下，可以得到答案</p><p><img src="/../image/Snipaste_2024-01-24_17-02-45.png" alt="img"></p>]]></content>
      
      
      <categories>
          
          <category> 网络攻防学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MD5 </tag>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
